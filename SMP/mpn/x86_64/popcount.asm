section .text
align 32
global	__gmpn_popcount
__gmpn_popcount:
	push	rdi
	push	rsi
	mov	rdi, rcx
	mov	rsi, rdx
	lea	rdi, [rdi+rsi*8]
	xor	eax, eax
	test	sil, 1
	jnz	Lbx1
Lbx0:
	test	sil, 2
	jnz	Lb10
Lb00:
	mov	ecx, 0
	sub	rcx, rsi
 db 0xf3,0x4c,0x0f,0xb8,0x04,0xcf
 db 0xf3,0x4c,0x0f,0xb8,0x4c,0xcf,0x08
	jmp	qword Llo0
Lb10:
	mov	ecx, 2
	sub	rcx, rsi
 db 0xf3,0x4c,0x0f,0xb8,0x54,0xcf,0xf0
 db 0xf3,0x4c,0x0f,0xb8,0x5c,0xcf,0xf8
	test	rcx, rcx
	jz	Lcj2
	jmp	qword Llo2
Lbx1:
	test	sil, 2
	jnz	Lb11
Lb01:
	mov	ecx, 1
	sub	rcx, rsi
 db 0xf3,0x4c,0x0f,0xb8,0x5c,0xcf,0xf8
	test	rcx, rcx
	jz	Lcj1
 db 0xf3,0x4c,0x0f,0xb8,0x04,0xcf
	jmp	qword Llo1
Lb11:
	mov	rcx, -1
	sub	rcx, rsi
 db 0xf3,0x4c,0x0f,0xb8,0x4c,0xcf,0x08
 db 0xf3,0x4c,0x0f,0xb8,0x54,0xcf,0x10
	jmp	qword Llo3
align 32
Ltop:
	add	rax, r9
Llo2:
 db 0xf3,0x4c,0x0f,0xb8,0x04,0xcf
	add	rax, r10
Llo1:
 db 0xf3,0x4c,0x0f,0xb8,0x4c,0xcf,0x08
	add	rax, r11
Llo0:
 db 0xf3,0x4c,0x0f,0xb8,0x54,0xcf,0x10
	add	rax, r8
Llo3:
 db 0xf3,0x4c,0x0f,0xb8,0x5c,0xcf,0x18
	add	rcx, 4
	js	Ltop
Lend:
	add	rax, r9
Lcj2:
	add	rax, r10
Lcj1:
	add	rax, r11
	pop	rsi
	pop	rdi
	ret
